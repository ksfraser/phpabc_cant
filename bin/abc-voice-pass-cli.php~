#!/usr/bin/env php
<?php
// Pass 1: Voice assignment and melody-to-bagpipes copy
require_once __DIR__ . '/../vendor/autoload.php';
use Ksfraser\PhpabcCanntaireachd\CliOutputWriter;
use Ksfraser\PhpabcCanntaireachd\CLIOptions;

use Ksfraser\PhpabcCanntaireachd\AbcParser;
use Ksfraser\PhpabcCanntaireachd\AbcValidator;

use Ksfraser\PhpabcCanntaireachd\AbcVoicePass;
use Ksfraser\PhpabcCanntaireachd\AbcFileParser;

$cli = CLIOptions::fromArgv($argv);
$file = $cli->file;
$xnum = $cli->xnum;

if (!$file || !file_exists($file)) {
    $msg = "ABC file not found.\n";
    if ($errorFile) {
        CliOutputWriter::write($msg, $errorFile);
    } else {
        fwrite(STDERR, $msg);
    }
    exit(1);
}

$abcContent = file_get_contents($file);
$parser = new AbcFileParser();
$tunes = $parser->parse($abcContent);
var_dump( $parser );
var_dump( $tunes );
